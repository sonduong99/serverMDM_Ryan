<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=GBK">
  <title>&#8206;</title>
  <link rel="apple-touch-icon-precomposed" href="http://abc.haoyunlai.xyz/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="./style.css">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="icon.png">
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json">
  <style>
    /* Font bộ đếm */
    #counter {
      font-size: 2.5rem; /* tăng từ 2rem lên 2.5rem */
      color: #00cc66;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-weight: bold; /* làm đậm hơn */
      margin-top: 10px;
    }
    /* Cảnh báo cuối trang */
    .dierhang {
      text-align: center;
      margin: 40px 20px 20px 20px;
      font-size: 18px;   /* tăng từ 15px lên 18px */
      line-height: 1.6;  /* giãn dòng dễ đọc hơn */
      color: #ffcc00; /* giống màu V25051817 ( Phạm Sơn Dương ) */
    }
  </style>
</head>

<body>
  <div class="zhengti">
    <div class="juzuo1">
      V25051817 ( Phạm Sơn Dương )
    </div>
    <div class="saomatishi juzhong" id="biaoti">
      将二维码对准扫描器扫码进出场
    </div>

    <div class="yuan1 yuant"></div>
    <div class="yuan2 yuant"></div>

    <div class="juzhong erweima zise">
      <div class="juzuo2" id="dateTime00" style="font-weight: 500;"></div>
      <div id="neirong">
        <img class="ewm" src="./ewm.gif">
      </div>
      <div id="neirong1">
        <div>
          <a class="juzhong footsty shuaxinerweima" style="margin-top: 2rem; font-size: 3.3rem"
            href="javascript:location.reload()">刷新二维码</a>
        </div>
      </div>
      <div class="juzhong footsty yishengxiao word_breath">
        <div style="display:" onclick="changetxt()">已生效</div>
      </div>
      <div class="juzhong footsty shijian">
        <!-- Bộ đếm 12 tiếng -->
        <div id="counter">00:00:00</div>
      </div>
    </div>
  </div>

  <!-- Cảnh báo cuối trang -->
  <div class="dierhang">
    尊敬的员工您好，您已进入企业涉密区域，出于企业安全考虑，您的手机摄像头将被禁止拍摄，感谢您的配合。
  </div>

  <script>
    // Hiển thị đồng hồ ngày giờ
    Date.prototype.format = function (fmt) {
      var o = {
        "y+": this.getFullYear(),
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
      };
      if (/(y+)/.test(fmt))
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      for (var k in o)
        if (new RegExp("(" + k + ")").test(fmt))
          fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) :
            (("00" + o[k]).substr(("" + o[k]).length)));
      return fmt;
    };

    setInterval(function () {
      const dt = document.getElementById('dateTime00');
      if (dt) {
        dt.innerHTML = (new Date()).format('yyyy-M-d hh:mm:ss');
      }
    }, 1000);

    // Bộ đếm 12 tiếng (07:55–19:55 và 19:55–07:55), đếm tiến
    function updateCounter() {
      const now = new Date();

      // Mốc 07:55 hôm nay
      let cycleStart = new Date(now);
      cycleStart.setHours(7, 55, 0, 0);

      // Nếu hiện tại < 07:55 thì lùi về hôm qua 07:55
      if (now < cycleStart) {
        cycleStart.setDate(cycleStart.getDate() - 1);
      }

      const cycleDuration = 12 * 60 * 60 * 1000; // 12 tiếng
      let elapsed = now - cycleStart;
      let inCycle = elapsed % cycleDuration;

      let hours = Math.floor(inCycle / (1000 * 60 * 60));
      let minutes = Math.floor((inCycle % (1000 * 60 * 60)) / (1000 * 60));
      let seconds = Math.floor((inCycle % (1000 * 60)) / 1000);

      document.getElementById("counter").innerText =
        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    setInterval(updateCounter, 1000);
    updateCounter();

    function changetxt() {
      document.getElementById('biaoti').innerText = "您的设备已符合安全规范";
      document.getElementById('neirong').innerHTML =
        "<img class='true' src='./true.png'><div class='truetxt'><p class='jinchang'>进场成功</p><p class='riqi' id='dateTime01'></p></div>";

      setInterval(function () {
        const dt = document.getElementById('dateTime01');
        if (dt) {
          dt.innerHTML = (new Date()).format('yyyy-MM-dd hh:mm');
        }
      }, 1000);
    }
  </script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').then(() => {
        console.log("Service Worker Registered v3");
      });
    }
  </script>
</body>
</html>